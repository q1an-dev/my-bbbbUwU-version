<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>Â∞èÁ´†È±º(ChienÁâà)</title>
    <meta name="theme-color" content="#FFFFFF"/>
    <meta name="apple-mobile-web-app-capable" content="yes">
    <link rel="apple-touch-icon" href="https://i.postimg.cc/cLV7R0zf/xiao-zhang-yu-Chien.jpg">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <script src="https://unpkg.com/dexie/dist/dexie.js"></script>
    <script src="https://unpkg.com/dompurify@2.3.8/dist/purify.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/echarts@5.5.0/dist/echarts.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
    <link rel="manifest" href="manifest.json">

    <!-- Â§ñÈÉ®CSSÊñá‰ª∂ÂºïÁî® -->
    <link rel="stylesheet" href="Chien-styles.css">
</head>

<body>
    <div class="phone-screen">
        <!-- Home Screen -->
        <section id="home-screen" class="screen active"></section>

        <!-- Chat List Screen -->
        <section id="chat-list-screen" class="screen">
            <header class="app-header">
                <button class="back-btn" data-target="home-screen">‚Äπ</button>
                <div class="title-container">
                    <h1 class="title">404</h1>
                </div>
                <div class="action-btn-group">
                    <button class="action-btn" id="import-character-card-btn" title="ÂØºÂÖ•ËßíËâ≤Âç°">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                            <path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"/>
                        </svg>
                    </button>
                    <button class="action-btn" id="add-chat-btn" title="Êñ∞Âª∫ËÅäÂ§©">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                            <path d="M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"/>
                        </svg>
                    </button>
                </div>
            </header>
            <main class="content">
                <ul id="chat-list-container" class="list-container"></ul>
                <div id="no-chats-placeholder" class="placeholder-text">ÊöÇÊó†ËÅäÂ§©ËÆ∞ÂΩïÔºåÁÇπÂáªÂè≥‰∏ãËßíÊ∑ªÂä†</div>
            </main>
        </section>

        <!-- Chat Room Screen -->
        <section id="chat-room-screen" class="screen">
            <header id="chat-room-header-default" class="app-header">
                <button class="back-btn" data-target="chat-list-screen">‚Äπ</button>
                <div class="title-container">
                    <h1 class="title" id="chat-room-title">ËßíËâ≤ÂêçÁß∞</h1>
                    <span class="subtitle" id="chat-room-status-text">
                        <span class="online-indicator"></span>Âú®Á∫ø
                    </span>
                </div>
                <div class="action-btn-group">
                    <button class="action-btn" id="chat-settings-btn" title="ËÆæÁΩÆ">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                            <path d="M12 8c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2zm0 2c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm0 6c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2z"/>
                        </svg>
                    </button>
                </div>
            </header>
            <header id="chat-room-header-select" class="app-header" style="display: none;">
                <button id="cancel-multi-select-btn" class="back-btn">ÂèñÊ∂à</button>
                <div class="title-container">
                    <h1 class="title" id="multi-select-title">ÈÄâÊã©Ê∂àÊÅØ</h1>
                </div>
                <div class="placeholder"></div>
            </header>
            <div class="content">
                <div id="message-area" class="message-area"></div>
                <div id="typing-indicator" class="typing-indicator" style="display: none;">ÂØπÊñπÊ≠£Âú®ËæìÂÖ•‰∏≠<span class="typing-dots"><span>.</span><span>.</span><span>.</span></span></div>
                <div class="chat-input-wrapper">
                    <div id="reply-preview-bar" class="reply-preview-bar">
                        <span class="reply-preview-name"></span>
                        <span class="reply-preview-text"></span>
                        <button id="cancel-reply-btn" class="cancel-reply-btn">√ó</button>
                    </div>
                    <div class="message-input-area">
                        <input type="text" id="message-input" placeholder="ËæìÂÖ•Ê∂àÊÅØ..." />
                        <button id="send-message-btn" class="icon-btn send-btn" disabled>‚û§</button>
                    </div>
                    <div id="sticker-bar">
                        <button id="sticker-toggle-btn" class="sticker-bar-btn" title="Ë°®ÊÉÖÂåÖ">
                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                                <path d="M11.99 2C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2zM12 20c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8zm3.5-9c.83 0 1.5-.67 1.5-1.5S16.33 8 15.5 8 14 8.67 14 9.5s.67 1.5 1.5 1.5zm-7 0c.83 0 1.5-.67 1.5-1.5S9.33 8 8.5 8 7 8.67 7 9.5 7.67 11 8.5 11zm3.5 6.5c2.33 0 4.31-1.46 5.11-3.5H6.89c.8 2.04 2.78 3.5 5.11 3.5z"/>
                            </svg>
                        </button>
                        <button id="voice-message-btn" class="sticker-bar-btn" title="ËØ≠Èü≥Ê∂àÊÅØ">
                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                                <path d="M12 14c1.66 0 3-1.34 3-3V5c0-1.66-1.34-3-3-3S9 3.34 9 5v6c0 1.66 1.34 3 3 3zm5.91-3c-.49 0-.9.36-.98.85C16.52 14.2 14.47 16 12 16s-4.52-1.8-4.93-4.15c-.08-.49-.49-.85-.98-.85-.61 0-1.09.54-1 1.14.49 3 2.89 5.35 5.91 5.78V20c0 .55.45 1 1 1s1-.45 1-1v-2.08c3.02-.43 5.42-2.78 5.91-5.78.1-.6-.39-1.14-1-1.14z"/>
                            </svg>
                        </button>
                        <button id="photo-video-btn" class="sticker-bar-btn" title="ÁÖßÁâá/ËßÜÈ¢ë">
                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                                <path d="M21 19V5c0-1.1-.9-2-2-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2zM8.5 13.5l2.5 3.01L14.5 12l4.5 6H5l3.5-4.5z"/>
                            </svg>
                        </button>
                        <button id="image-recognition-btn" class="sticker-bar-btn" title="ÂõæÁâáËØÜÂà´">
                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                                <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm0 16H5V5h14v14zm-5.04-6.71l-2.75 3.54-1.96-2.36L6.5 17h11l-3.54-4.71z"/>
                            </svg>
                        </button>
                        <button id="wallet-btn" class="sticker-bar-btn" title="Èí±ÂåÖ">
                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                                <path d="M21 18v1c0 1.1-.9 2-2 2H5c-1.11 0-2-.9-2-2V5c0-1.1.89-2 2-2h14c1.1 0 2 .9 2 2v1h-9c-1.11 0-2 .9-2 2v8c0 1.1.89 2 2 2h9zm-9-2h10V8H12v8zm4-2.5c-.83 0-1.5-.67-1.5-1.5s.67-1.5 1.5-1.5 1.5.67 1.5 1.5-.67 1.5-1.5 1.5z"/>
                            </svg>
                        </button>
                        <button id="gift-btn" class="sticker-bar-btn" title="Á§ºÁâ©">
                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                                <path d="M20 6h-2.18c.11-.31.18-.65.18-1a2.996 2.996 0 0 0-5.5-1.65l-.5.67-.5-.68C10.96 2.54 10.05 2 9 2 7.34 2 6 3.34 6 5c0 .35.07.69.18 1H4c-1.11 0-1.99.89-1.99 2L2 19c0 1.11.89 2 2 2h16c1.11 0 2-.89 2-2V8c0-1.11-.89-2-2-2zm-5-2c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zM9 4c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1z"/>
                            </svg>
                        </button>
                        <button id="time-skip-btn" class="sticker-bar-btn" title="Êó∂Èó¥Ë∑≥ËΩ¨">
                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                                <path d="M11.99 2C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2zM12 20c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8zm.5-13H11v6l5.25 3.15.75-1.23-4.5-2.67z"/>
                            </svg>
                        </button>
                        <button id="get-reply-btn" class="sticker-bar-btn" title="Ëé∑ÂèñÂõûÂ§ç" disabled>
                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                                <path d="M20 2H4c-1.1 0-1.99.9-1.99 2L2 22l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm-7 12h-2v-2h2v2zm0-4h-2V6h2v4z"/>
                            </svg>
                        </button>
                        <button id="regenerate-btn" class="sticker-bar-btn" title="ÈáçÊñ∞ÁîüÊàê" disabled>
                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                                <path d="M17.65 6.35C16.2 4.9 14.21 4 12 4c-4.42 0-7.99 3.58-7.99 8s3.57 8 7.99 8c3.73 0 6.84-2.55 7.73-6h-2.08c-.82 2.33-3.04 4-5.65 4-3.31 0-6-2.69-6-6s2.69-6 6-6c1.66 0 3.14.69 4.22 1.78L13 11h7V4l-2.35 2.35z"/>
                            </svg>
                        </button>
                        <button id="placeholder-plus-btn" class="sticker-bar-btn" title="Êõ¥Â§ö">
                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                                <path d="M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"/>
                            </svg>
                        </button>
                    </div>
                </div>
            </div>
        </section>

        <!-- ÂÖ∂‰ªñÂ±èÂπïÂç†‰ΩçÁ¨¶ -->
        <section id="api-settings-screen" class="screen"></section>
        <section id="wallpaper-screen" class="screen"></section>
        <section id="font-settings-screen" class="screen"></section>
        <section id="customize-screen" class="screen"></section>
        <section id="tutorial-screen" class="screen"></section>
        <section id="world-book-screen" class="screen"></section>
        <section id="forum-screen" class="screen"></section>
        <section id="music-screen" class="screen"></section>
        <section id="diary-screen" class="screen"></section>
        <section id="piggy-bank-screen" class="screen"></section>
        <section id="pomodoro-screen" class="screen"></section>
        <section id="storage-analysis-screen" class="screen"></section>

        <!-- ËÅäÂ§©ËÆæÁΩÆ‰æßËæπÊ†è -->
        <div id="chat-settings-sidebar" class="settings-sidebar">
            <div class="header">ËÅäÂ§©ËÆæÁΩÆ</div>
            <div class="content">
                <form id="settings-form">
                    <div class="avatar-setting">
                        <img src="https://i.postimg.cc/Y96LPskq/o-o-2.jpg" alt="Avatar" class="avatar-preview" id="setting-avatar-preview">
                    </div>
                    <div class="form-group">
                        <label for="setting-real-name">ËßíËâ≤ÂêçÁß∞</label>
                        <input type="text" id="setting-real-name">
                    </div>
                    <div class="form-group">
                        <label for="setting-remark-name">Â§áÊ≥®ÂêçÁß∞</label>
                        <input type="text" id="setting-remark-name">
                    </div>
                    <div class="form-group">
                        <label for="setting-my-name">ÊàëÁöÑÁß∞Âëº</label>
                        <input type="text" id="setting-my-name">
                    </div>
                    <div class="form-group">
                        <label for="setting-my-avatar">ÊàëÁöÑÂ§¥ÂÉè</label>
                        <img src="https://i.postimg.cc/GtbTnxhP/o-o-1.jpg" alt="My Avatar" class="avatar-preview" id="setting-my-avatar-preview">
                    </div>
                    <div class="form-group">
                        <label for="setting-persona">ËßíËâ≤ËÆæÂÆö</label>
                        <textarea id="setting-persona" rows="4"></textarea>
                    </div>
                    <div class="form-group">
                        <label for="setting-my-persona">ÊàëÁöÑ‰∫∫ËÆæ</label>
                        <textarea id="setting-my-persona" rows="4"></textarea>
                    </div>
                    <div class="form-group">
                        <label for="setting-theme">‰∏ªÈ¢òÈ¢úËâ≤</label>
                        <select id="setting-theme">
                            <option value="white_pink">ÁôΩ/Á≤â</option>
                            <option value="white_blue">ÁôΩ/Ëìù</option>
                            <option value="white_yellow">ÁôΩ/ÈªÑ</option>
                            <option value="white_green">ÁôΩ/Áªø</option>
                            <option value="white_purple">ÁôΩ/Á¥´</option>
                            <option value="black_red">Èªë/Á∫¢</option>
                            <option value="black_green">Èªë/Áªø</option>
                            <option value="black_white">Èªë/ÁôΩ</option>
                            <option value="white_black">ÁôΩ/Èªë</option>
                            <option value="yellow_purple">ÈªÑ/Á¥´</option>
                            <option value="pink_blue">Á≤â/Ëìù</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="setting-max-memory">ÊúÄÂ§ßËÆ∞ÂøÜÊù°Êï∞</label>
                        <input type="number" id="setting-max-memory" min="1" max="50">
                    </div>
                    <div class="form-group">
                        <label for="setting-chat-bg">ËÅäÂ§©ËÉåÊôØÂõæURL</label>
                        <input type="url" id="setting-chat-bg">
                    </div>
                    <div class="form-group">
                        <label for="setting-status">Âú®Á∫øÁä∂ÊÄÅ</label>
                        <select id="setting-status">
                            <option value="Âú®Á∫ø">Âú®Á∫ø</option>
                            <option value="Á¶ªÂºÄ">Á¶ªÂºÄ</option>
                            <option value="ÂøôÁ¢å">ÂøôÁ¢å</option>
                            <option value="ÈöêË∫´">ÈöêË∫´</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="setting-use-custom-css">‰ΩøÁî®Ëá™ÂÆö‰πâÊ∞îÊ≥°CSS</label>
                        <input type="checkbox" id="setting-use-custom-css">
                    </div>
                    <div class="form-group">
                        <label for="setting-custom-bubble-css">Ëá™ÂÆö‰πâÊ∞îÊ≥°CSS</label>
                        <textarea id="setting-custom-bubble-css" rows="6"></textarea>
                    </div>
                    <div id="private-bubble-css-preview" style="margin: 10px 0;"></div>
                    <div class="form-group" style="display: flex; justify-content: space-between; align-items: center;">
                        <label for="bubble-preset-select">Ê∞îÊ≥°È¢ÑËÆæÂ∫ì</label>
                        <button type="button" id="apply-preset-to-chat" class="btn btn-primary btn-small">Â∫îÁî®</button>
                    </div>
                    <select id="bubble-preset-select" style="width: 100%; margin-bottom: 10px;"></select>
                    <div style="display: flex; gap: 5px; margin-bottom: 10px;">
                        <button type="button" id="save-as-bubble-preset" class="btn" style="flex: 1;">Â≠ò‰∏∫È¢ÑËÆæ</button>
                        <button type="button" id="manage-bubble-presets" class="btn" style="flex: 1;">ÁÆ°ÁêÜ</button>
                    </div>
                    <div class="form-group" style="display: flex; justify-content: space-between; align-items: center;">
                        <label for="mypersona-preset-select">ÊàëÁöÑ‰∫∫ËÆæÈ¢ÑËÆæÂ∫ì</label>
                        <button type="button" id="apply-mypersona-to-chat" class="btn btn-primary btn-small">Â∫îÁî®</button>
                    </div>
                    <select id="mypersona-preset-select" style="width: 100%; margin-bottom: 10px;"></select>
                    <div style="display: flex; gap: 5px; margin-bottom: 10px;">
                        <button type="button" id="save-as-mypersona-preset" class="btn" style="flex: 1;">Â≠ò‰∏∫È¢ÑËÆæ</button>
                        <button type="button" id="manage-mypersona-presets" class="btn" style="flex: 1;">ÁÆ°ÁêÜ</button>
                    </div>
                    <button type="submit" class="btn btn-primary">‰øùÂ≠òËÆæÁΩÆ</button>
                    <button type="button" class="btn btn-neutral" id="clear-chat-history-btn">Ê∏ÖÁ©∫ËÅäÂ§©ËÆ∞ÂΩï</button>
                </form>
            </div>
        </div>

        <!-- ÂêÑÁßçÊ®°ÊÄÅÊ°ÜÂç†‰ΩçÁ¨¶ -->
        <div id="add-char-modal" class="modal-overlay">
            <div class="modal-window">
                <h3>Ê∑ªÂä†Êñ∞ËßíËâ≤</h3>
                <form id="add-char-form">
                    <input type="file" id="character-card-input" accept=".png,.json" style="display: none;">
                    <div class="form-group">
                        <label for="char-real-name">ËßíËâ≤ÂêçÁß∞</label>
                        <input type="text" id="char-real-name" required>
                    </div>
                    <div class="form-group">
                        <label for="char-remark-name">Â§áÊ≥®ÂêçÁß∞</label>
                        <input type="text" id="char-remark-name" required>
                    </div>
                    <div class="form-group">
                        <label for="my-name-for-char">‰Ω†ÁöÑÁß∞Âëº</label>
                        <input type="text" id="my-name-for-char" required>
                    </div>
                    <button type="button" class="btn btn-neutral" id="import-character-card-btn">ÂØºÂÖ•ËßíËâ≤Âç°</button>
                    <button type="submit" class="btn btn-primary">ÂàõÂª∫</button>
                    <button type="button" class="back-btn" onclick="this.closest('.modal-overlay').classList.remove('visible')">ÂèñÊ∂à</button>
                </form>
            </div>
        </div>

        <!-- Ë°®ÊÉÖÂåÖÊ®°ÊÄÅÊ°Ü -->
        <div id="sticker-modal" class="modal-overlay">
            <div class="modal-window">
                <div class="header">
                    Ë°®ÊÉÖÂåÖ
                    <button class="action-btn" id="sticker-manage-mode-btn" title="ÁÆ°ÁêÜ">üìù</button>
                </div>
                <div class="sticker-grid-container"></div>
            </div>
        </div>

        <!-- Ê∑ªÂä†Ë°®ÊÉÖÂåÖÊ®°ÊÄÅÊ°Ü -->
        <div id="add-sticker-modal" class="modal-overlay">
            <div class="modal-window">
                <h3 id="add-sticker-modal-title">Ê∑ªÂä†Ë°®ÊÉÖÂåÖ</h3>
                <form id="add-sticker-form">
                    <input type="hidden" id="sticker-edit-id">
                    <div class="form-group">
                        <label for="sticker-name">ÂêçÁß∞</label>
                        <input type="text" id="sticker-name" required>
                    </div>
                    <div class="form-group">
                        <label for="sticker-url-input">ÂõæÁâáURL</label>
                        <input type="url" id="sticker-url-input" placeholder="https://...">
                    </div>
                    <div class="form-group">
                        <label>Êàñ‰∏ä‰º†ÂõæÁâá</label>
                        <input type="file" id="sticker-file-upload" accept="image/*">
                    </div>
                    <div id="sticker-preview">È¢ÑËßà</div>
                    <div class="form-group">
                        <label for="sticker-category-select">ÂàÜÁ±ª</label>
                        <select id="sticker-category-select"></select>
                    </div>
                    <button type="submit" class="btn btn-primary">‰øùÂ≠ò</button>
                </form>
            </div>
        </div>

        <!-- Ë°®ÊÉÖÂåÖÊìç‰ΩúËèúÂçï -->
        <div id="sticker-actionsheet" class="action-sheet-overlay">
            <div class="action-sheet">
                <button id="edit-sticker-btn" class="action-sheet-button">ÁºñËæë</button>
                <button id="delete-sticker-btn" class="action-sheet-button danger">Âà†Èô§</button>
                <button class="action-sheet-button" onclick="this.closest('.action-sheet-overlay').classList.remove('visible')">ÂèñÊ∂à</button>
            </div>
        </div>

        <!-- ÂÖ∂‰ªñÊ®°ÊÄÅÊ°ÜÂíåÂÖÉÁ¥†Â∞ÜÂú®ËøôÈáåÂä®ÊÄÅÁîüÊàê -->

    </div>

    <!-- Â§ñÈÉ®JavaScriptÊñá‰ª∂ÂºïÁî® -->
    <script src="Chien-script.js"></script>
</body>

</html>